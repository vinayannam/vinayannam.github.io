<!--Created by vinay-->
<!DOCYTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Heatmap</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: transparent;
        }
        
        #canvas {
            margin-left: 11px;
            margin-top: 11px;
            background-color: transparent;
        }
        
        #legend {
            padding-left: 10px;
            padding-top: 35px;
            position: relative;
            margin-left: 249.5px;
            margin-top: -128px;
            width: 80px;
            height: 100px;
            color: white;
        }
        
        #legendMax,
        #legendMin {
            font-size: 10px;
            font-family: monospace;
        }

    </style>
</head>

<body>
    <script src="jquery.min.js"></script>
    <script src="heatmap.js"></script>
    <script src="../node_modules/socket.io-client/dist/socket.io.js"></script>
    <div id="heat">
        <canvas id="canvas" width="600px" height="400px"></canvas>
    </div>
    <div id="legend">
        <div id="legendMax"></div>
        <div id="legendMin"></div>

    </div>
    <script>
        var div = document.getElementById('canvas');

        var context = div.getContext('2d');
        var svg = new Image();
        svg.src = "general.svg";
        svg.onload = function() {
            context.drawImage(svg, 0, 0);
        };

        var config = {
            container: document.getElementById('heat')
            //                radius: 12
            //                maxOpacity: .5,
            //                minOpacity: 0,
            //                gradient:{'.5': 'blue',
            //                            '.8': 'red',
            //                            '.95': 'white'
            //                          }
        };

        var heatmapInstance = h337.create(config);

        var socket = io.connect('http://10.7.2.161:3000');

        var values;

        var janval,
            febval,
            marval,
            aprval,
            mayval,
            junval,
            julval,
            augval,
            sepval,
            octval,
            novval,
            decval;

        socket.on('newclient', function(jan, feb, mar, apr, may, jun, jul, aug, sep, oct, nov, dec, year) {
            janval = jan;
            febval = feb;
            marval = mar;
            aprval = apr;
            mayval = may;
            junval = jun;
            julval = jul;
            augval = aug;
            sepval = sep;
            octval = oct;
            novval = nov;
            decval = dec;
            yearval = year;
        });




        function C5() {
            return {
                x: 30,
                y: 157,
                value: values[18]
            }
        };

        function C4() {
            return {
                x: 30,
                y: 195,
                value: values[17]
            }
        };

        function C6() {
            return {
                x: 63,
                y: 139,
                value: values[19]
            }
        };

        function C7() {
            return {
                x: 90,
                y: 139,
                value: values[20]
            }
        };

        function C3() {
            return {
                x: 83,
                y: 210,
                value: values[16]
            }
        };

        function C2() {
            return {
                x: 112,
                y: 210,
                value: values[15]
            }
        };

        function C1() {
            return {
                x: 140,
                y: 210,
                value: values[14]
            }
        };

        function B5() {
            return {
                x: 122,
                y: 260,
                value: values[11]
            }
        };

        function B4() {
            return {
                x: 122,
                y: 300,
                value: values[10]
            }
        };

        function B6() {
            return {
                x: 152,
                y: 244,
                value: values[12]
            }
        };

        function B7() {
            return {
                x: 182,
                y: 244,
                value: values[13]
            }
        };

        function B3() {
            return {
                x: 174,
                y: 315,
                value: values[9]
            }
        };

        function B2() {
            return {
                x: 203,
                y: 315,
                value: values[8]
            }
        };

        function B1() {
            return {
                x: 231,
                y: 315,
                value: values[7]
            }
        };

        function D5() {
            return {
                x: 165,
                y: 32,
                value: values[25]
            }
        };

        function D4() {
            return {
                x: 202,
                y: 32,
                value: values[24]
            }
        };

        function D6() {
            return {
                x: 143,
                y: 65,
                value: values[26]
            }
        };

        function D7() {
            return {
                x: 143,
                y: 91,
                value: values[27]
            }
        };

        function D3() {
            return {
                x: 217,
                y: 84,
                value: values[23]
            }
        };

        function D2() {
            return {
                x: 217,
                y: 111,
                value: values[22]
            }
        };

        function D1() {
            return {
                x: 217,
                y: 140,
                value: values[21]
            }
        };

        var os = 2 * 290;

        function F5() {
            return {
                x: os - 30,
                y: 157,
                value: values[39]
            }
        };

        function F4() {
            return {
                x: os - 30,
                y: 195,
                value: values[38]
            }
        };

        function F6() {
            return {
                x: os - 63,
                y: 139,
                value: values[40]
            }
        };

        function F7() {
            return {
                x: os - 90,
                y: 139,
                value: values[41]
            }
        };

        function F3() {
            return {
                x: os - 83,
                y: 210,
                value: values[37]
            }
        };

        function F2() {
            return {
                x: os - 112,
                y: 210,
                value: values[36]
            }
        };

        function F1() {
            return {
                x: os - 140,
                y: 210,
                value: values[35]
            }
        };

        function A5() {
            return {
                x: os - 122,
                y: 260,
                value: values[4]
            }
        };

        function A4() {
            return {
                x: os - 122,
                y: 300,
                value: values[3]
            }
        };

        function A6() {
            return {
                x: os - 152,
                y: 244,
                value: values[5]
            }
        };

        function A7() {
            return {
                x: os - 182,
                y: 244,
                value: values[6]
            }
        };

        function A3() {
            return {
                x: os - 174,
                y: 315,
                value: values[2]
            }
        };

        function A2() {
            return {
                x: os - 203,
                y: 315,
                value: values[1]
            }
        };

        function A1() {
            return {
                x: os - 231,
                y: 315,
                value: values[0]
            }
        };

        function E5() {
            return {
                x: os - 165,
                y: 32,
                value: values[32]
            }
        };

        function E4() {
            return {
                x: os - 202,
                y: 32,
                value: values[31]
            }
        };

        function E6() {
            return {
                x: os - 143,
                y: 65,
                value: values[33]
            }
        };

        function E7() {
            return {
                x: os - 143,
                y: 91,
                value: values[34]
            }
        };

        function E3() {
            return {
                x: os - 217,
                y: 84,
                value: values[30]
            }
        };

        function E2() {
            return {
                x: os - 217,
                y: 111,
                value: values[29]
            }
        };

        function E1() {
            return {
                x: os - 217,
                y: 140,
                value: values[28]
            }
        };

        function data() {
            return {
                max: 500,
                min: 0,
                data: [A1(), A2(), A3(), A4(), A5(), A6(), A7(), B1(), B2(), B3(), B4(), B5(), B6(), B7(), C1(), C2(), C3(), C4(), C5(), C6(), C7(), D1(), D2(), D3(), D4(), D5(), D6(), D7(), E1(), E2(), E3(), E4(), E5(), E6(), E7(), F1(), F2(), F3(), F4(), F5(), F6(), F7()]
            }
        };

        var legendMax = document.getElementById('legendMax');
        var legendMin = document.getElementById('legendMin');

        function dataAdder(month) {
            var defvalues = [],
                i = 0;
            for (i = 0; i < month.length; i++) {
                defvalues.push(month[i]);
            }
            values = defvalues;
            heatmapInstance.setData(data());

            values = values.sort(function(a, b) {
                return a - b;
            });
            legendMax.innerHTML = "Max: " + values[values.length - 1];
            legendMin.innerHTML = "Min: " + values[0];

        }

        socket.on('f1Jan', function() {
            dataAdder(janval);
        });
        socket.on('f1Feb', function() {
            dataAdder(febval);
        });
        socket.on('f1Mar', function() {
            dataAdder(marval);
        });
        socket.on('f1Apr', function() {
            dataAdder(aprval);
        });
        socket.on('f1May', function() {
            dataAdder(mayval);
        });
        socket.on('f1Jun', function() {
            dataAdder(junval);
        });
        socket.on('f1Jul', function() {
            dataAdder(julval);
        });
        socket.on('f1Aug', function() {
            dataAdder(augval);
        });
        socket.on('f1Sep', function() {
            dataAdder(sepval);
        });
        socket.on('f1Oct', function() {
            dataAdder(octval);
        });
        socket.on('f1Nov', function() {
            dataAdder(novval);
        });
        socket.on('f1Dec', function() {
            dataAdder(decval);
        });
        socket.on('f1Year', function() {
            dataAdder(yearval);
        });

    </script>
</body>

</html>
